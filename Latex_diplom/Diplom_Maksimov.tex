\documentclass[a4paper,14pt]{article}         % класс документа - статья. Также report, book и др.
\usepackage{geometry}           % пакет для задания полей страницы командой \geometry
\geometry{a4paper, left=3cm,right=1.5cm,top=2cm,bottom=2cm}
\usepackage[cp1251]{inputenc}   % кодировка текста
\usepackage{mathtext}           % позволяет использовать русские буквы в формулах
\usepackage[T2A]{fontenc}       %пакет Т2А необходим для правильного отображения кириллицы и переноса слов
%\inputencoding{cp1251}          % тоже кодировка...
\usepackage[russian]{babel}     % языковой пакет - последний язык главный
%\usepackage[unicode]{hyperref}  %создаёт гиперссылки на список литературы в pdf-файле
\usepackage{amstext,amsmath,amssymb}            % пакеты для формул
\usepackage{bm}                 % boldmath - пакет для жирного шрифта
\usepackage[pdftex]{graphicx}   % пакет для включения рисунков в форматах png,pdf,jpg,mps,tif
                                % надо компилировать сразу в pdf
\usepackage{hyperref}			% ссылки
\usepackage{amsfonts}           % греческие символы и, возможно, что-то ещё
\usepackage{indentfirst}        % одинаковый отступ для первого параграфа и всего остального
%\usepackage{cite}               % команда /cite{1,2,7,9} даёт ссылки
\usepackage{multirow}           % пакет для объединения строк в таблице: надо указать число строк и ширину столбца
\usepackage{array}              % нужен для создания таблиц
\linespread{1.3}                % полтора интервала. Если 1.6, то два интервала

% Подписи рисунков
\usepackage[font=Large,labelfont=bf]{caption}
\DeclareCaptionLabelSeparator{defffis}{ --- }
\captionsetup{justification   = raggedright,
			singlelinecheck = false,
			labelsep=defffis}
\usepackage{subcaption}

% Шрифты секций
\usepackage{sectsty}
\sectionfont{\centering\fontsize{14}{15}\selectfont}
\subsectionfont{\fontsize{14}{15}\selectfont}
\subsubsectionfont{\fontsize{14}{15}\selectfont}

% Внутри секции картинки
\usepackage[section]{placeins}
% рекомендуется при использвоании biblatex
%\usepackage{csquotes}
\if 0
\usepackage[%
autolang=other,       
bibencoding=utf8,
sorting=nty, % Name,Title,Year или sorting=none.
maxbibnames=4, % Максимальное число авторов в списке литературы.
minbibnames=2, % Число авторов, отображаемое при сокращении.
style=gost-numeric,
backend=biber]{biblatex}
\addbibresource{./cite/LibraryDB-01.bib}
\addbibresource{./cite/LibraryDB-02.bib}
\fi
%
\if 0 \usepackage{titlesec}
\titleformat{\section}
{\normalfont\fontsize{14}{15}\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
{\normalfont\fontsize{14}{15}\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
{\normalfont\fontsize{14}{15}\bfseries}{\thesubsubsection}{1em}{}
\fi		%
\usepackage{xcolor}
%\titleformat{\section}[block]{\Large\bfseries\filcenter}{}{1em}{}
\pagestyle{plain}               % номерует страницы
\parindent=1.25cm				% правильный размер красных строк
\renewcommand{\theenumii}{\asbuk{enumii}} % списки с русским алфавитом

% Listings
\usepackage{listings}
\usepackage{color}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}

\lstset{style=mystyle}
\begin{document}	

\Large
\begin{titlepage}
\begin{center}
Министерство образования и науки РФ

Московский Физико-Технический Институт \\
(национальный исследовательский университет)\\

Факультет общей и прикладной физики\\
Кафедра вычислительной физики конденсированного состояния и живых систем\\
\end{center}

\vspace{5cm}

\begin{center}
\LARGE \bf{Протокол для поиска возможных неспецифичных взаимодействий лигандов}
\end{center}

\begin{center}\large
Диплом на соискание степени бакалавра
\end{center}

\vspace{3cm}

\large
\begin{flushright}
\textbf{Выполнил:}\\
студент группы 527и\\
Максимов Антон Сергеевич\\

\vspace{1cm}

\textbf{Научный руководитель:}\\
(к. ф.-м. н.) \\
Попов Пётр Анатольевич
\end{flushright}

\vspace{1cm}

\begin{center}
Долгопрудный 2019
\end{center}

\end{titlepage}

\begin{center}
\LARGE\bf{Аннотация}

\end{center}


\setcounter{page}{2}            % Нумерация страниц начинается с "2"

\newpage                        % Начинает текст с новой страницы
\tableofcontents                % Автоматическое создание оглавления по названиям разделов, подразделов и т.п.

\newpage
\section*{Определения, обозначения и сокращения}

\textbf{Лиганд} -- в биологии это химическое соединение, обычно малая молекула, которая образует комплекс с той или иной биомолекулой-мишенью (чаще всего белком) и производит, вследствие такого связывания, те или иные биохимические, физиологические или фармакологические эффекты.

\textbf{Мишень} -- биомолекула, с которой может связываться молекула-лиганд, производя некоторый биологический эффект в организме.

\textbf{FDA} -- американское управление по санитарному надзору за качеством пищевых продуктов и медикаментов (англ. Food and Drug \linebreak Administration) -- служба, занимающаяся контролем качества лекарственных препаратов, пищевых продуктов  и других продуктов, а также осуществляющая контроль за соблюдением законодательства и стандартов в этой области. 

\textbf{Метрика подобия или схожести} -- способ сопоставить всем парам объектов из входных данных одного типа некоторые числа, позволяющие судить о схожести этих объектов.

\textbf{а/к} -- аминокислотный или аминокислота (в зависимости от контекста).

\textbf{ID} -- идентификатор.

\textbf{БД} -- база данных.

\textbf{ПМ} -- программный модуль.

\color{gray}
\textbf{GPCR} -- рецепторы, сопряженные с G-белком (англ. G-protein-coupled receptors)

\textbf{ТМ} -- трансмембранный участок

\textbf{МГ} -- моделирование по гомологии

\textbf{МД} -- молекулярная динамика
\color{black}
\newpage
\section{Введение}
Математическое моделирование и вычислительные методы давно стали неотъемлемой частью исследований в биологии и  медицине, причем налицо тенденция к росту важности и востребованности таких методов и в фундаментальной науке, и в приложениях. Так, в современной фармакологии высокопроизводительный скрининг  является важнейшим этапом отсева молекул-кандидатов на статус лекарства перед дорогостоящими клиническими испытаниями, позволяющим значительно сократить количество затрачиваемых на поиск лекарства времени и сил.

Одним из методов поиска и отсева кандидатов является сравнение с уже известными лекарствами, имеющими положительные и побочные эффекты. Таким способом можно производить поиск как новых мишеней для уже известных лекарств, так и по известным важным мишеням находить новые лекарства. Однако, насколько нам известно, на сегодняшний день не существует публично доступного программного модуля, позволяющего искать кандидатов в новые лекарственные средства с помощью различных способов вычисления подобия.

\textbf{Целью} данной работы являлось построение такого гибко настраиваемого программного протокола для поиска неспецифичных взаимодействий между лигандами и мишенями. 

Для достижения этой цели были предложены следующие этапы:
\begin{enumerate}
	\item извлечь из доступных баз данных биологических соединений необходимую информацию о подтвержденных FDA лекарствах, соответствующих лигандах и мишенях, и реализовать это в программном коде;
	\item создать функции для конвертации данных одной молекулы в требуемые сторонними программами форматы;
	\item создать функции для сравнения одного элемента входных данных с одной подтвержденной FDA записью;
	\item реализовать поиск наиболее подходящих в терминах различных метрик подобия лигандов/мишеней/комплексов.
\end{enumerate}
\subsection{Обзор литературы}
\subsubsection{Полифармакология}
При разработке лекарств важно добиться селективности, избавившись от побочных действий. Именно эта парадигма <<одно лекарство -- одна мишень>>, так называемая таргетированная терапия, до недавнего времени широко использовалась в фармакологии. С другой стороны, в последнее время стала осознаваться важность полифармакологии, которая означает множественное, но специфичное воздействие лекарства на многие мишени, позволяющее добиться синергетического эффекта и более эффективного лечения комплексных заболеваний, таких как рак\cite{Anighoro2014}. 

При этом полифармакология может выгодно отличаться от комбинирования нескольких лекарств, так как:

(а) единственная молекула обычно имеет более предсказумую и безопасную фармакокинетику; 

(б) часто действующие на несколько мишеней лекарства имеют \linebreak {б\textbf{о}льшую} эффективность на поздних стадиях заболевания; 

(в) не нужно учитывать эффекты перекрестного взаимодействия лекарств, которые, являясь негативными, переносятся хуже в случае комбинационной терапии; 

(г) при прочих равных меньше вероятность вырабатывания лекарственной устойчивости к одному лекарству, чем к хотя бы одному из набора лекарств \cite{Anighoro2014}.

Стоит заметить, что каждый белковый домен в среднем содержит 3-5 связывающих карманов достаточного размера для связывания с типичными малыми лигандами \cite{SKOLNICK20151163}. Таким образом, существует возможность выбрать новый карман, отличный от ранее использовавшихся, для разработки лекарства. К тому же, количество видов связывающих карманов со статистически значимыми различиями оценивается, как меньшее 400 \cite{SKOLNICK20151163}, что позволяет считать полифармакологическую картину взаимодействий лиганд-мишень неизбежной, и потому более перспективной, чем таргетированная.

Новая парадигма подчеркивает важность поиска всевозможных пар взаимодействий лиганд-мишень. Такой анализ может аккумулировать результаты уже известных связей, приводя к построению сложных сетей \cite{Anighoro2014}, но важнее уметь предсказывать такие взаимодействия. Так как перебор и оценка силы всех взаимодействий лиганд-мишень \textit{in vivo} и \textit{in vitro} является непрактичной, в этом направлениии активно развиваются компьютерные методы \cite{Chaudhari}.

\subsubsection{Неспецифичные взаимодействия}
Неспецифичные взаимодействия -- дополнительные взаимодействия выбранного лиганда/мишени с другими, кроме основных,  {мишенями/лигандами}. Одной из основных проблем в поиске таких взаимодействий исходя из структуры является то, что часто эти связи в большой степени определяются подвижными частями рецептора, которые сложно или невозможно исследовать с достаточной атомарной точностью \cite{Loving}.

Принципиально, структурный поиск субъектов неспецифичного взаимодействия может осуществляться по структуре: (а) мишени; (б) лиганда; (в) связывающего сайта \cite{Rognan2010}.

(а) при поиске возможных лигандов по известной структуре мишени, воспроизводится обычный процесс современного дизайна лекарств, а именно высокопроизводительный скрининг по базе возможных лигандов. Таким образом, в сущности, оценивается, насколько сложно найти лиганд для этой мишени. Процесс можно ускорить, используя поиск по так называемым <<горячим точкам>>, то есть набору мест на поверхности мишени, где максимальна энергия связывания с потенциальным лигандом \cite{Hall2015}, что напоминает концепцию фармакофорного поиска.

(б) поиск по структуре лиганда по сути своей близок к понятию \linebreak \textbf{repurposing'a}, которое заключается в поиске новых мишеней и применений для лекарств, которые уже выпущены на рынок. Это позволяет сократить расходы на преклиническую стадию и оптимизацию \cite{Hall2015, March-Vila2017}.

(в) связывающие сайты могут сравниваться по различным характеристикам, таким как геометрические и физикохимические свойства поверхности мишени, профили взаимодействия или структура остова. Также нахождение связывающих карманов само по себе сложная задача, к которой существует несколько подходов (\text{добавить, как ее решать}) \cite{Ehrt2016}. 

Связывающие сайты могут описываться разными способами. Например, как трехмерный граф из вершин-атомов, содиненный ребрами-длинами. Или же как облако точек, то есть чисто геометрически. В этих моделях могут выделяться основанные на фармакофорном принципе черты, которые в дальнейшем позволяют значительно ускорить поиск. Один из наиболее затратных в вычислениях, но и чувствительных методов -- построение карт электронной плотности \cite{Ehrt2016}.
\cite{Cabrera}
\cite{Brylinski}
\cite{Govindaraj2018}
\subsubsection{Существующие протоколы}
\color{orange} ДОПИСАТЬ ОБЗОР, чего не хватает в существующих, недостатки\cite{Chartier2017}
\color{black}


\newpage
\section{Основное содержание}
\subsection{Общая структура протокола}
Опишем общую структуру протокола (см. рис. \ref{structure}).

Так как для поиска по подобию нужны референсные данные, то необходимо найти их источник. Далее, извлекая сведения об подтвержденных FDA лекарствах, можно, используя эту же и другие базы данных биомолекул, получать необходимую для дальнейшего поиска информацию о свойствах референсных лигандов/мишеней и извлекать структурную информацию о них и их комплексах.

После этого с помощью сторонних программных пакетов и собственного кода достигается цель -- нахождение списка лигандов/мишеней/комплексов наиболее близких к входным данным.

\begin{figure}                          % Пример рисунка, состоящего из 6 картинок
	\begin{minipage}[!ht]{1\linewidth}         % Создаём "маленькие" рисунки шириной 47% от ширины страницы
		\caption{Общая схема структуры протокола.}
		\centering{\includegraphics[width=1.0\linewidth]{Drawio/3}} % Вставляем рисунок в полученное "окно" полностью - 100%
		\label{structure}
	\end{minipage}
\end{figure}

\subsection{Материалы и методы исследования}
\subsubsection{Биологические базы данных}
\color{orange} Описание устройства баз и примеры: Drugbank, Uniprot, PDB, Pubchem. \color{black}
\subsubsection{Коэффициент Танимото}
\subsubsection{Сходство белков по аминокислотной последовательности}
Чтобы вычислить сходство белков по их аминокислотным последовательностям был использован модуль Biopython(\href{https://biopython.org/}{https://biopython.org}). Он позволяет вычислить подобие и идентичность (\color{orange} ОПРЕДЕЛЕНИЯ \color{black}) двух а/к последовательностей.(\color{orange} КАК РАБОТАЕТ \color{black}) 
\subsubsection{Сходство белков по структуре}
Для вычисления сходства белков, используя их структуру, использована программа TM-align (\href{https://zhanglab.ccmb.med.umich.edu/TM-align}{https://zhanglab.ccmb.med.umich.edu/TM-align}) \cite{TM-align}. Сначала с помощью динамического программирования определяется оптимальное наложение двух белков друг на друга, которое, вообще, является NP-трудной задачей \cite{} и потому требует существенных вычислительных ресурсов. После этого вычисляется TM-score (англ. Template Modeling score)\cite{Levitt1998} 
\begin{equation}
\label{tm-score}
\text{TM-score} = \max\left[\frac{1}{L_{target}}\sum_i^{L_{aligned}}\frac{1}{1+\left(\frac{d_i}{d_0(L_{target})}\right)^2}\right],
\end{equation}
где $L_{target}$ -- количество а/к в целевом белке, сравниваемом с другими; $L_{aligned}$ -- количество а/к в выравненной части двух белков, $d_i$ -- расстояние между $i$-й парой остатков в белках; $d_0$ -- нормировочный коэффициент $d_0(L_{target}) = 1.24\sqrt[3]{L_{target}-15}-1.8$; сумма производится по парам соответствущих оснований. TM-score нормирован таким образом, что его значение меньше 0,2 говорит об отсутствии корреляций в структурах, а превышение эмпирической границы в 0,5 означает, что укладки белков практически совпадают \cite{TM-align}. 

Одновременно считается и коэффициент RMSD (англ. Root Mean Square Deviation) %\ref{rmsd}
\begin{equation}
\label{rmsd}
\text{RMSD} = \sqrt{\frac{1}{N}\sum_{i=1}^N \delta_i},
\end{equation}
где $N$ -- количество атомов в молекуле; $\delta_i$ -- отклонение $i$-го атома от второй структуры.

TM-score считается более подходящим для оценки подобия белков, чем RMSD, так как в отличие от RMSD он не зависит от длин сравниваемых белков (нормируется на полусумму их длин и находится в полуинтервале $(0, 1]$), а также учитывает различные области белков с разными весами, что позволяет получать адекватные результаты для структур с одинаковой глобальной топологией, но небольшими отклонениями по всей длине белка. В случае использования RMSD результат будет подразумевать то, что структуры различны, а TM-score, вероятнее всего, детектирует схожесть \cite{TM-align}.
\subsubsection{Сходство лигандов по структуре}
Чтобы найти сходство лигандов по их топологической структуре, ичспользуются молекулярные отпечатки \cite{Cereto-Massague2015}. Принцип работы заключается в том, что в каждой молекуле находятся и хэшируются заранее заданные топологические пути по связям. (\color{orange} добавить другие типы\color{black})Получающиеся битовые строки двух сравниваются, что приводит к коэффициенту Танимото как оценке степени подобия структур.

Мы использовали вычисление таких отпечатков по SMILES и SDF файлу (реализованы соответственно с помощью модуля  \linebreak RDkit  (\href{http://www.rdkit.org/docs/index.html}{http://www.rdkit.org/docs/index.html}) и \linebreak Open Babel  (\href{http://openbabel.org/wiki/Main\_Page}{http://openbabel.org/wiki/Main\_Page}))
\subsubsection{Сходство сайтов связывания}
Для вычисления подобия сайтов связывания используется программный пакет IsoMIF (\href{https://github.com/mtthchrtr/IsoMif}{https://github.com/mtthchrtr/IsoMif})\cite{Chartier2015}, считающийся одним из лучших для данного вычисления \cite{Ehrt2016}. (\color{orange} ТОЧНО??? Проверить\color{black})

Суть его работы состоит в нахождении полостей в структуре компекса лиганд-мишень(\color{orange} подробнее как ищутся \color{black}). 

После этого с помощью встроенной в пакет программы MIF (англ. Molecular Interaction Field) в области сайта связывания строится сетка, в каждом узле которой считаются энергии взаимодействия пробника определенного типа с соседними атомами белка до некоторого радиуса обрезки. Всего используется 6 типов свойств пробника: гидробофность, ароматичность, способность быть донором/акцептором водородной связи, положительный/отрицательный электрический заряд, энергии спадают одинаково и экспоненциально от расстояния, а значения энергий на 1 \AA $\:$ подбираются эмпирически для всевозможных пар из 6 типов пробника и 13 типов атома белка (см. рис. \ref{cleft_mif}(б)).

После получения этих сеток для двух сайтов связывания (с 6 значениями энергии в каждом узле) происходит построение графа, у которого вершины обозначают пары узлов сетки, берущихся по одному из сравниваемых структур и имеющих хотя бы один общий из 6 тип энергии больше некоторого порога, то есть является значимым. Ребра в этом графе строятся, если расстояния между соответствующими узлами в двух полостях отличаются менее, чем на 3 \AA. 

Затем в этом графе производится поиск наибольшей клики (полного подграфа) с помощью алгоритма Брона — Кербоша \cite{Bron1973, Tomita2006} и с использованием эвристического наблюдения, что наибольшая клика часто находится одной из первых, так что для значительного уменьшения вычислительной нагрузки проводится только 100 поисков по умолчанию. 

Результат работы алгоритма -- мера подобия полостей, -- вычисляется как
\begin{equation}
\text{MSS} = \frac{N_c}{N_a + N_b - N_c},
\end{equation} \cite{Chartier2015}.
где $N_c$ -- количество значимых общих типов взаимодействий у всех вершин в клике, $N_a, N_b$ -- количества значимых типов взаимодействий в узлах сеток для первого и второго белка. 

\color{orange} TM-align?\color{black}
\begin{figure} 
	\caption{Визуализация работы (а) поиска полостей и (б)вычисления MIF(\color{orange} сделать картинки одного формата \color{black})}   
	\label{cleft_mif} 
	\begin{subfigure}{.45\textwidth}
		\centering
		\includegraphics[width=1\linewidth]{pictures/clefts}
		\caption{Найденные полости комплекса показаны разными цветами.}
		\label{fig:sfig1}
	\end{subfigure}
\hfill
	\begin{subfigure}{.45\textwidth}
		\centering
		\includegraphics[width=1\linewidth]{pictures/mif}
		\caption{Размеченная с помощью MIF полость, где разные цвета обозначают тип максимального по энергии взаимодействия с соседями в этой области.}
		\label{fig:sfig1}
	\end{subfigure}
\end{figure}
\newpage
\subsection{Описание программного модуля и результаты}
Программный код на языке программирования Python 3.7 \linebreak(\href{https://www.python.org/downloads/release/python-370}{https://www.python.org/downloads/release/python-370}) и содержащий более ?1000 строк доступен в репозитории \href{https://github.com/antmaxi/BSc\_thesis}{https://github.com/antmaxi/BSc\_thesis}.

Модуль состоит из четырех программ: Search.py, Drugbank.py, IsoMIF.py, Auxiliary.py, различные функции из которых могут вызываться посредством вызова программы Search.py с соответствующими потребностям пользователя или другой программы ключами. \color{orange} ключи еще не сделаны \color{black}

Состав программ:
\begin{enumerate}
	\item 
\end{enumerate}
В Search.py находится большее количество функций обработки данных для получения значений метрик схожести. В
Работа модуля была протестирована но компьютере с операционной системой Ubuntu 16.04 LTS 64-bit, с процессором Intel® Core™ i9-7940X CPU @ 3.10GHz $\times$ 28 и видеокартой GeForce GTX 1080 Ti/PCIe/SSE2.
\subsubsection{Извлечение данных}
Было решено производить извлечение референсных данных из базы данных Drugbank (\href{https://www.drugbank.ca/}{https://www.drugbank.ca/}), так как она является наиболее полной и хорошо аннотированной БД лекарств \ref{} и содержит не только информацию о лигандах, но и о мишенях вместе с ссылками на другие специфические источники информации. 

Хотя в приложении к полной БД Drugbank находятся таблицы с частью нужной для работы протокола информации (ссылки на другие БД, химические идентификаторы), было принято решение извлекать информацию напрямую из полной БД, что позволяет: 

(а) не зависить от обновления приложений ко всей БД. которые могут запаздывать относительно общего обновления БД; 

(б) делать поиск по нужным записям/свойства более гибким и простым для будущих модификаций и усовершенствований протокола.

\subsubsection{Сходство белков по аминокислотной последовательности}
Сравнение одной пары от доли секунды до около секунд, вся база данных ~10-30 минут.
\subsubsection{Сходство белков по структуре}
\color{orange} В ПРОЦЕССЕ, КОД ПИШУ
\color{black}
\subsubsection{Сходство лигандов по структуре}
\color{orange} ОТНОСИТЕЛЬНО ПОДРОБНО РАСПИСАНО, ТАК ВСЕ БУДУТ ТИПЫ ПОИСКОВ (+КАРТИНКИ НАДО)
\color{black}

Поиск по ID SMILES:

Из БД Drugbank извлекаются соответствующие ID SMILES подтвержденных FDA лигандов. Информация дополняется извлеченными из БД PubChem (\href{https://pubchem.ncbi.nlm.nih.gov}{https://pubchem.ncbi.nlm.nih.gov}) идентификаторами тех лигандов, у которых их нет в БД Drugbank, но которые имеют запись в БД PubChem.

Далее, с помощью ПМ RDkit строятся и сравниваются молекулярные отпечатки, вычисляется коэффициент Танимото между ними, приводя к отсортированному по степени подобия списку подтвержденных FDA лигандов.

Поиск по структуре в формате SDF:

С сайта БД Drugbank скачивается файл со структурами всех лигандов в формате .sdf, из него по ID в БД Drugbank извлекаются структуры подтвержденных FDA лигандов. Затем по этим структурам получаются молекулярные отпечатки, вычисляется коэффициент Танимото между ними, результируя в искомом списке.

Пример работы:
\begin{lstlisting}[language=Python, caption=Cходство лигандов по молекулярным отпечаткам с помощью Open Babel]
In: 
	get_closest_ligands_from_3d_structure(path_to_structure, path_to_sdf_approved, root,
										  									fptype='maccs', number_to_print=5)
	(ЗАМЕНЮ, КОГДА СДЕЛАЮ ЧЕРЕЗ argparse)
Out:
								Name  				Tanimoto coeff 	Drugbank ID 	Fingerprint_type
	0  Dichlorobenzyl alcohol        0.343284     DB13269              fp2
	1         Tiludronic acid        0.317647     DB01133              fp2
	2           Chloroxylenol        0.308824     DB11121              fp2
	3             Sulconazole        0.290598     DB06820              fp2
	4               Guanabenz        0.268293     DB00629              fp2
CPU times: user 1.87 s, sys: 7.68 ms, total: 1.88 s
Wall time: 1.88 s
\end{lstlisting}
\color{orange} НУЖНО ЛИ ПОДРОБНО ОБЪЯСНЯТЬ, ЧТО ВВОДИТСЯ, ЧТО ВЫВОДИТСЯ?
\color{black}
\color{orange} КАРТИНКА СО СРАВНЕНИЕМ ИЗОБРАЖЕНИЙ МОЛЕКУЛ
\color{black}

Время поиска по фармакофорам 1-3 сек.
\subsubsection{Сходство сайтов связывания}
Для скрининга комплекса из входных данных по референсным комплексам необходимо каким-то образом получить их структуры.  поля каждой пары лиганд-мишень, извлеченных из БД Drugbank,

Время построения MIF 1-3 мин, вычисления IsoMIF 3-5 мин, остальные части длятся пренебрежимо мало.

\newpage
\section{Заключение}
Построен протокол поиска подобных и соответствующих подтвержденным FDA лигандов/мишеней/комплексов по нескольким типам входных данных с использованием различных способов задания вычисления подобия: по 1D-, 2D-, 3D-структурам. Работа протокола проверена и задокументирована, программный код и примеры опубликованы в открытом доступе. 

Из-за своей модульной структуры в будущем протокол может дополняться новыми вариантами нахождения меры схожести. Также на его основе с применением машинного обучения могут быть построены более сложные методы поиска, учитывающие несколько различных метрик подобия.
(\color{orange} В ПРОЦЕССЕ \color{black})


\color{red}
Наверное, про GPCR не стоит говорить отдельно, они же нигде мной не выделяются (то, что писал осенью, не нужно)
\color{gray}
\subsection{Рецепторы, сопряженные с G-белком}
Семейство GPCR состоит из около 800 многофункциональных белков-рецепторов \cite{Fredriksson1256}, регулирующих разнообразные внутриклеточные сигнальные каскады в ответ на гормоны, нейротрансмиттеры, ионы, фотоны, одоранты и другие стимулы\cite{Hilger2018}. Поэтому они играют важнейшую роль в физиологии и разработке лекарств, представляя собой привлекательную мишень для лекарственных средств. Около трети всех лекарств, одобренных Управлением по санитарному надзору за качеством пищевых продуктов и медикаментов США, действуют именно на мишени из этого класса, хотя это всего чуть более ста различных рецепторов, то есть порядка десятой части всего семейства\cite{Hauser2017}.

Белки, принадлежащие семейству GPCR, состоят из семи трансмембранных спиралей, связанных тремя внутриклеточными и внеклеточными петлями. Внеклеточная часть, с которой связывается лиганд, также включает в себя N-конец. Внутриклеточная часть содержит кроме петель также восьмую спираль и C-конец и взаимодействует с G белками, аррестинами и другими \textbf{downstream effectors}	\cite{Katritch2012Diversity}. 

Трансмембранная часть является наиболее консервативной в структуре белков семейства, что не мешает рецепторам из различных подсемейств обеспечивать крайнее разнообразие в форме, размере и электростатических свойствах связывающихся с ними лигандов за счет вариаций в структуре связывающих карманов. 	
Их гидрофобность и закрытость с внеклеточной стороны связаны с функциями рецептора \cite{Katritch2012Diversity}.

Несмотря на колоссальный прогресс в кристаллографии GPCR, пространственная структура известна только у небольшой доли рецепторов. Важная роль компьютерного моделирования состоит в раскрытии структур остальных рецепторов и их комплексов \cite{KUFAREVA20141120} и последующем рациональном создании лекарств.
\subsection{Сайты связывания и специфичность}
Хотя природные лиганды внутри семейства GPCR очень разнообразны, белки одного подтипа имеют практически одинаковые конформации активных сайтов, что позволяет моделировать их компьютерными методами с высокой точностью
\cite{Katritch2012}. Некоторые подсемейства рецепторов взаимодействуют с одним и тем же \textbf{endogenous} лигандом, и в этом случае отсутствие больших различий в ортостерических связывающих карманах, где и происходит взаимодействие \textbf{endogenous} лиганда и рецептора, представляет вызов для поиска селективных лигандов и явялется одной из главных проблем в разработке безопасных и эффективных лекарств, действующих на GPCR \cite{KATRITCH2011108}.

Исторически дизайн лекарств был направлен на создание лигандов, подобных \textbf{endogenous}, которые искусственно активировали сигнальные пути. Другой классический подход состоит в создании антагонистов~-- веществ, способных конкурировать с природным лигандом, не активируя при этом работу рецептора. 

В последнее время произошел взрывной рост количества новых методов использования GPCR в качестве мишени. Например, многие недавно разработанные лиганды действуют в активном сайте, топологически отделенном от ортостерического. Такие сайты и лиганды называются <<аллостерическими>>, причем лиганды могут как усиливать работу рецептора, так и ослаблять ее \cite{SHONBERG20153880}. Возможна даже комбинация фармакофоров ортостерических и аллостерических лигандов (\textbf{bitopic ligands}) в одном лиганде, который будут теоретически иметь лучшую аффинность и селективность за счет большего количества связей с рецептором\cite{Wootten2013}.

Простейший механизм активации GPCR включает в себя два состояния, между которыми балансирует рецептор: активное, в котором происходит передача сигнала внутрь клетки, и неактивное. Агонисты смещают это равновесие в сторону активной конформации, обратные агонисты - в сторону неактивного. Эффективность агониста определяется преобладанием \textit{аффинности к активному состоянию над неактивным(звучит коряво)}. К настоящему моменту стало очевидно, что различные лиганды, воздействуя на один и тот же рецептор, могут стабилизировать его в различных конформациях, так что активными остается только часть всех возможных сигнальных путей, в который вовлечен этот рецептор. Такой процесс называется \textbf{biased} агонизм \cite{Lane2017}.
%	\cite{Vasile2018}
\color{black}

\color{red}
Дальше всё по моделированию по гомологии (с осени), что, наверное, другая тема и не будет использоваться здесь (тем более, что MODELLER не использую, часть с мутациями, кажется, выходит за пределы)
\color{gray}
\subsection{Построение модели белка}
Итогом развития геномного секвенирования в последнее время стал резкий рост количества известных белковых последовательностей, в то время, как только около одной сотой доли последовательностей охарактеризована с атомистической точностью и с использованием экспериментальных методов определения структуры \cite{Webb2017}.

В таких условиях полученные компьютерными методами модели структур белков часто являются ценными для выдвижения проверяемых гипотез. Такие модели, в целом, создаются с использованием методов сравнительного моделирования или свободного моделирования (\textbf{free modelling}), также называемых <<ab initio>> или <<de novo>>\cite{Webb2017}.

Сравнительное моделирование, или моделирование на основе гомологии (МГ), базируется на построении модели по известным структурам близких (\textbf{related} белков, как по шаблонам. Принцип \textbf{Free modelling} подхода в использовании не структуры близких белков, а в применении разнообразных методов, комбинирующих физику и известные особенности структур белков, например, сопоставление большого количества небольших фрагментов, выделенных из известных структур белков. Конструирование белков этим методом обычно чрезвычайно затратно в плане вычислений\cite{Webb2017}. Современные пакеты моделирования зачастую комбинируют эти два подхода, используя, если доступны шаблоны, МГ для построения основы-скелета белка, а затем уточняя положения петель, боковых цепей и частей без шаблона.

Моделирование требует наличия схемы сэмплирования конформаций с целью получения набора альтернативных структур. Также необходима оценивающая функция для ранжирования этих конформаций по качеству. Для этих целей было предложено большое количество физически обоснованных (\textbf{physics-based}) функций энергии и статистических потенциалов, полученных из анализа известных структур \cite{BetterDOPE}.

Так, например, MODELLER сначала накладывает входную последовательность на шаблонный остов, а затем, внося случайные смещения атомов, ищет локальный минимум оценивающей функции, повторяя эту процедуру несколько раз \cite{Webb2017}.  



Значительное увеличение количества решенных структур GPCR позволяет строить с атомистической точностью пространственные структуры большого количества рецепторов при отсутствии экспериментально полученной структуры целевого белка \cite{Tautermann2017}.

Построение модели состоит из нескольких этапов, результатом которых является физически и биологически адекватная модель белка. Ими являются: (1) определение сходства набора последотельностей с целевой и выделение шаблонов; (2) выравнивание целевой последовательности и шаблона(ов); (3) построение модели, основанной на выравнивании с выбранными шаблонами; (4) предсказание точности модели \cite{Webb2017}.
\subsubsection{Выделение шаблонов и множественное выравнивание последовательностей}
Сначала, беря аминокислотную последовательность заданного белка с неизвестной пространственной структурой, необходимо получить набор белков с известной 3D-структурой для последующего <<сшивания>> соответствующих участков.


Для этого используются различные подходы к поиску шаблонов и множественному выравниванию соответствующих им последовательностей:

1) PSI-BLAST\cite{ALTSCHUL1990403, Altschul1997}: с помощью матрицы вероятностей замен аминокислот BLOSUM62 и штрафа за пропуски производится поиск наиболее близких последовательностей в базе до некоторого порога близости. Далее, c использованием программы Clustal \cite{Thompson} эти последовательности выравниваются с исходной в совокупности. А именно, ... \textbf{алгоритм}

2) HHBlits \cite{Remmert2011} -- быстрее и чувствительнее BLAST, но ... (\textbf{недостатки}). Использует предварительно кластеризованные с помощью kClustal \cite{Hauser2013} базы Uniprot и nr. \\
Общее описание алгоритма: (а) приведение запроса из одной последовательности (выравнивание) или нескольких (множественное выравнивание) к скрытой марковской модели (СММ, сопоставление каждой позиции в последовательности вектора вероятностей размерности 1х20 обнаружить ту или иную аминокислоту на этом месте) производится добавлением к исходной  последовательностей, отличающихся от нее заменами аминокислот на похожие по физико-химическим свойствам. При этом учитывается локальный контекст в 13 оснований вокруг замены, а суммарная энергия этих замен должна быть меньше некоторого задаваемого порога, что важно для скорости и чувствительности алгоритма. Далее, каждая строка в исходной СММ причисляется к одному из 219 типичных профилей-кластеров последовательностей, создавая строку-профиль этой СММ. После этого сначала проводится выравнивание этого профиля СММ с предварительно созданными профилями из базы данных, потом -- обычное выравнивание уже входной последовательности внутри cоответствующего профилю СММ кластера базы данных. (\textbf{наверное, так много тут не надо, просто разбирался в алгоритме})

3) GPCRdb.org -- при исследовании GPCR проще всего использовать готовые выравнивания с сайта базы данных GPCRdb (\textit{зачем тогда вообще другие нам?}).
\subsubsection{Моделирование белка и оценка качества модели}

Моделирование из выровненного набора шаблонов может производиться при помощи различных программных пакетов для предсказания четвертичной структуры белков. Среди них наиболее известным является MODELLER, но и, например, Rosetta \cite{ROHL200466} \cite{ Song2013}, Itasser\cite{iTasser}, RaptorX\cite{Raptor} могут быть использованы.
\cite{Deng}

При использовании пакета MODELLER в случае идентичности последовательностей более $30 \%$, в среднем более $\sim 60$ \% скелетных атомов моделируются корректно со средним квадратическим отклонением позиций $C \alpha$ атомов менее $3,5$ \AA. При меньшей идентичности, как правило, результат хуже \cite{Webb2017}.

\textit{какие у разных программ особенности и различия?}

Оценка качества модели \cite{DOPEShen2006}, 
\subsubsection{Уточнение модели}
Хотя современные программы МГ производят проверки физической и химической адекватности полученных моделей, за счет неточностей в выбранном силовом поле и просто недостаточности исходного покрытия последовательностями шаблонами, итоговые модели могут иметь значительные отличия от реальной структуры. 

Улучшение точности модели может производиться средствами молекулярной динамики (МД) \cite{Nowroozi}. Производя множественные траектории МД с полученной МГ моделью, помещенной в нативную среду, могут быть получены несколько устойчивых подсостояний белка с локально минимальными свободными энергиями%\cite{TAUTERMANN2015111}
, которые и будут считаться наиболее вероятными конформациями белка в мембране, что важно для GPCR.

\subsection{Поиск неспецифичных взаимодействий}
Определение, где находится активный центр и взаимодействует ли лиганд с рецептором, может быть проведено различными методами. Возможно использование докинга
\cite{Pradeep2012} и основанного на машинном обучении поиска....(\textit{что еще?})
\\

Заметки:\\
слишком много слов <<взаимодействие>>, надо придумать синонимов 

\color{black}


\


\newpage
%\printbibliography
\bibliographystyle{unsrt}
\bibliography{Diplom_lit} 

%\begin{thebibliography}{99}                    % Список литературы
%\addcontentsline{toc}{section}{Список литературы}

%\end{thebibliography}

\end{document}
